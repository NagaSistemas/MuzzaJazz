<!DOCTYPE html>
<html>
<head>
    <title>Teste Direto Pagamento</title>
    <script src="js/config.js"></script>
</head>
<body>
    <h1>Teste Direto do Pagamento</h1>
    <button onclick="testarPagamentoDireto()">Testar Pagamento Direto</button>
    <div id="resultado"></div>

    <script>
        async function testarPagamentoDireto() {
            console.log('🧪 Iniciando teste direto...');
            
            const reservaTeste = {
                id: Date.now().toString(),
                nome: 'Teste Cliente',
                whatsapp: '(62) 99999-9999',
                data: '2024-12-25',
                adultos: 2,
                criancas: 0,
                area: 'interna',
                valor: 100,
                observacoes: 'Teste direto'
            };

            console.log('📋 Dados da reserva:', reservaTeste);

            try {
                console.log('🔄 Enviando para API...');
                const response = await fetch(`${API_BASE_URL}/ipag/create-payment`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ reserva: reservaTeste })
                });

                console.log('📡 Status:', response.status);
                
                if (response.ok) {
                    const result = await response.json();
                    console.log('✅ Sucesso:', result);
                    
                    document.getElementById('resultado').innerHTML = `
                        <h3>✅ Pagamento criado!</h3>
                        <p><strong>URL:</strong> ${result.paymentUrl}</p>
                        <p><strong>Transaction ID:</strong> ${result.transactionId}</p>
                        <button onclick="window.location.href='${result.paymentUrl}'">IR PARA PAGAMENTO</button>
                    `;
                } else {
                    const error = await response.json();
                    console.error('❌ Erro:', error);
                    document.getElementById('resultado').innerHTML = `
                        <h3>❌ Erro</h3>
                        <p>${error.error}</p>
                    `;
                }
            } catch (error) {
                console.error('💥 Exceção:', error);
                document.getElementById('resultado').innerHTML = `
                    <h3>💥 Erro de conexão</h3>
                    <p>${error.message}</p>
                `;
            }
        }
    </script>
</body>
</html>